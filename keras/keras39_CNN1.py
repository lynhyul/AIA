
from tensorflow.keras.models import Sequential
from tensorflow.keras.layers import Conv2D,Dense,Flatten, MaxPooling2D

model = Sequential()
model.add(Conv2D(filters =100,kernel_size=(2,2), strides=1, padding='same',input_shape=(10,10,1)))   # 10,10크기(흑백) => (N,10,10,1)
# model.add(MaxPooling2D(pool_size=3))
model.add(Conv2D(9,(2,2)))      # padding의 디폴트 => padding = 'valid'
# model.add(Conv2D(9,(2,3)))
# model.add(Conv2D(8,2))
model.add(Flatten())
model.add(Dense(1))

model.summary()
'''
_________________________________________________________________
Layer (type)                 Output Shape              Param #
conv2d (Conv2D)              (None, 9, 9, 10)          50
_________________________________________________________________
dense (Dense)                (None, 9, 9, 1)           11
=================================================================
Total params: 61
Trainable params: 61
Non-trainable params: 0
_________________________________________________________________
conv2d layer를 통과 했을 때 출력의 차원이 그대로 나오는 것을 확인 할 수 있었다. 하지만 일반 dense의 layer는 2차원인데
conv2d는 4차원이기때문에 이대로 출력되면 문제가 생긴다. 이를 해결하는 방법이 Flatten이다
model.add(Flatten())


Layer (type)                 Output Shape              Param #
=================================================================
conv2d (Conv2D)              (None, 9, 9, 10)          50
_________________________________________________________________
flatten (Flatten)            (None, 810)               0
_________________________________________________________________
dense (Dense)                (None, 1)                 811
=================================================================
Total params: 861
Trainable params: 861
Non-trainable params: 0
_________________________________________________________________
정상 출력 된다.

Layer (type)                 Output Shape              Param #
=================================================================
conv2d (Conv2D)              (None, 9, 9, 10)          50
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 8, 8, 9)           369
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 7, 7, 8)           296
_________________________________________________________________
flatten (Flatten)            (None, 392)               0
_________________________________________________________________
dense (Dense)                (None, 1)                 393
=================================================================
Total params: 1,108
Trainable params: 1,108
Non-trainable params: 0
_________________________________________________________________

_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
conv2d (Conv2D)              (None, 10, 10, 10)        50
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 9, 9, 9)           369
_________________________________________________________________
flatten (Flatten)            (None, 729)               0
_________________________________________________________________
dense (Dense)                (None, 1)                 730
=================================================================
Total params: 1,149
Trainable params: 1,149
Non-trainable params: 0


#model.add(Conv2D(filters =10,kernel_size=(3,3),padding='same',input_shape=(10,10,1)))   # 10,10크기(흑백) => (N,10,10,1)
#model.add(Conv2D(9,(3,3)))  
_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
conv2d (Conv2D)              (None, 10, 10, 10)        100
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 8, 8, 9)           819
_________________________________________________________________
flatten (Flatten)            (None, 576)               0
_________________________________________________________________
dense (Dense)                (None, 1)                 577
=================================================================
Total params: 1,496
Trainable params: 1,496
Non-trainable params: 0
_________________________________________________________________


#strides=2
_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
conv2d (Conv2D)              (None, 5, 5, 10)          50
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 4, 4, 9)           369
_________________________________________________________________
flatten (Flatten)            (None, 144)               0
_________________________________________________________________
dense (Dense)                (None, 1)                 145
=================================================================
Total params: 564
Trainable params: 564
Non-trainable params: 0
_________________________________________________________________



#Maxpooling

Layer (type)                 Output Shape              Param #
=================================================================
conv2d (Conv2D)              (None, 5, 5, 10)          50
_________________________________________________________________
max_pooling2d (MaxPooling2D) (None, 2, 2, 10)          0
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 1, 1, 9)           369
_________________________________________________________________
flatten (Flatten)            (None, 9)                 0
_________________________________________________________________
dense (Dense)                (None, 1)                 10
=================================================================
Total params: 429
Trainable params: 429
Non-trainable params: 0
_________________________________________________________________


# stride = 1, Maxpooling
_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
conv2d (Conv2D)              (None, 10, 10, 10)        50
_________________________________________________________________
max_pooling2d (MaxPooling2D) (None, 5, 5, 10)          0
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 4, 4, 9)           369
_________________________________________________________________
flatten (Flatten)            (None, 144)               0
_________________________________________________________________
dense (Dense)                (None, 1)                 145
=================================================================
Total params: 564
Trainable params: 564
Non-trainable params: 0
_________________________________________________________________


#model.add(MaxPooling2D(pool_size=2))

Layer (type)                 Output Shape              Param #
=================================================================
conv2d (Conv2D)              (None, 10, 10, 10)        50
_________________________________________________________________
max_pooling2d (MaxPooling2D) (None, 5, 5, 10)          0
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 4, 4, 9)           369
_________________________________________________________________
flatten (Flatten)            (None, 144)               0
_________________________________________________________________
dense (Dense)                (None, 1)                 145
=================================================================
Total params: 564
Trainable params: 564
Non-trainable params: 0
_________________________________________________________________


#model.add(MaxPooling2D(pool_size=3))

Layer (type)                 Output Shape              Param #
=================================================================
conv2d (Conv2D)              (None, 10, 10, 10)        50
_________________________________________________________________
max_pooling2d (MaxPooling2D) (None, 3, 3, 10)          0
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 2, 2, 9)           369
_________________________________________________________________
flatten (Flatten)            (None, 36)                0
_________________________________________________________________
dense (Dense)                (None, 1)                 37
=================================================================
Total params: 456
Trainable params: 456
Non-trainable params: 0
_________________________________________________________________

# strides=(1,2)

_________________________________________________________________
Layer (type)                 Output Shape              Param #
=================================================================
conv2d (Conv2D)              (None, 10, 5, 10)         50
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 9, 4, 9)           369
_________________________________________________________________
flatten (Flatten)            (None, 324)               0
_________________________________________________________________
dense (Dense)                (None, 1)                 325
=================================================================
Total params: 744
Trainable params: 744
Non-trainable params: 0
_________________________________________________________________

_________________________________________________________________

'''